\hypertarget{namespace_display}{}\doxysection{Display Namespace Reference}
\label{namespace_display}\index{Display@{Display}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{namespace_display_aacbf91b9f8c57fc2cb892c45fd44e655}{init}} ()
\item 
void \mbox{\hyperlink{namespace_display_a74136dce435d7a569c5fb00d5f7afbe6}{cleanup}} ()
\item 
void \mbox{\hyperlink{namespace_display_a5edb1eb6aad9305091ed3479edc983d6}{set\+Rotation}} (int rotation)
\item 
void \mbox{\hyperlink{namespace_display_ac8bef7d31e6dd87afcbcac8477f4c5c9}{setup\+LVGL}} ()
\item 
void \mbox{\hyperlink{namespace_display_a78f08fa1900213ef37200b256396765c}{display\+Flush}} (lv\+\_\+disp\+\_\+drv\+\_\+t $\ast$disp, const lv\+\_\+area\+\_\+t $\ast$area, lv\+\_\+color\+\_\+t $\ast$color\+\_\+p)
\item 
void \mbox{\hyperlink{namespace_display_a3d51aeecf9902984e423412bbe757155}{touchpad\+Read}} (lv\+\_\+indev\+\_\+drv\+\_\+t $\ast$indev\+\_\+driver, lv\+\_\+indev\+\_\+data\+\_\+t $\ast$data)
\item 
void \mbox{\hyperlink{namespace_display_add3c94239d228504e67b3720541065cc}{display\+QRCode}} (const String \&invoice)
\item 
void \mbox{\hyperlink{namespace_display_ace6d523c48cf82aef610774be829b85b}{display\+Invoice\+Text\+Fallback}} (const String \&invoice)
\item 
Arduino\+\_\+\+GFX \& \mbox{\hyperlink{namespace_display_a18c2dedb3287a8213f6a7d8ce61de740}{get\+GFX}} ()
\item 
lv\+\_\+obj\+\_\+t $\ast$ \mbox{\hyperlink{namespace_display_acb0d0237a8d03c78c35bad1248d26eeb}{get\+QRCanvas}} ()
\item 
void \mbox{\hyperlink{namespace_display_a265f5a3b090df04fb0b928b84a2d7e17}{set\+QRCanvas}} (lv\+\_\+obj\+\_\+t $\ast$canvas)
\item 
void \mbox{\hyperlink{namespace_display_a0c478a57b622918a8499d369db409f85}{get\+Last\+Touch}} (int32\+\_\+t \&x, int32\+\_\+t \&y)
\item 
void \mbox{\hyperlink{namespace_display_a77664f233d6b5e98be33985eed783600}{set\+Backlight\+Brightness}} (uint8\+\_\+t brightness)
\item 
void \mbox{\hyperlink{namespace_display_aa8aef5688a630d912c6d9bd1c764c542}{turn\+Off\+Backlight}} ()
\item 
void \mbox{\hyperlink{namespace_display_a75d875ec473cbdd00bee7951951d81c0}{turn\+On\+Backlight}} ()
\item 
void \mbox{\hyperlink{namespace_display_a4882df71e0a4d79fcf601ee407c01c39}{turn\+On\+Backlight\+For\+Signing}} ()
\begin{DoxyCompactList}\small\item\em Turn on backlight for signing event with reduced backlight turn off timeout. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{namespace_display_aece4179acb03a4966d7064ef6946b091}{init\+Backlight\+Timeout}} ()
\item 
void \mbox{\hyperlink{namespace_display_a694dddf11915e58ecf50e9d9f0e9307f}{reset\+Backlight\+Timeout}} ()
\item 
void \mbox{\hyperlink{namespace_display_a4d65628d3c5e7294cfd734a86fe1122b}{check\+Backlight\+Timeout}} ()
\item 
bool \mbox{\hyperlink{namespace_display_a28603b6415f9f3c21a4e9fed5ed180e3}{is\+Backlight\+On}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
Arduino\+\_\+\+Data\+Bus $\ast$ \mbox{\hyperlink{namespace_display_a73886cb9320187c094593787bd00d01c}{bus}} = nullptr
\item 
Arduino\+\_\+\+GFX $\ast$ \mbox{\hyperlink{namespace_display_a07404a97983810db305db509cbf74a9a}{g}} = nullptr
\item 
Arduino\+\_\+\+Canvas $\ast$ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}} = nullptr
\item 
\mbox{\hyperlink{class_a_x_s15231_b___touch}{AXS15231\+B\+\_\+\+Touch}} \mbox{\hyperlink{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}{touch}} (\mbox{\hyperlink{pincfg_8h_aadfd1e71ec456dc27c0b939972b57425}{Touch\+\_\+\+SCL}}, \mbox{\hyperlink{pincfg_8h_a2aa469c181d9c18e7f810f7c2505732e}{Touch\+\_\+\+SDA}}, \mbox{\hyperlink{pincfg_8h_a5a0375f1cc3ad48d5b72844acf697f1e}{Touch\+\_\+\+INT}}, \mbox{\hyperlink{pincfg_8h_a47174ce4cf77383332568190e90e7e2e}{Touch\+\_\+\+ADDR}}, \mbox{\hyperlink{dispcfg_8h_a966806ff3abf821022944c7aa191f997}{TFT\+\_\+rot}})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespace_display_a4d65628d3c5e7294cfd734a86fe1122b}\label{namespace_display_a4d65628d3c5e7294cfd734a86fe1122b}} 
\index{Display@{Display}!checkBacklightTimeout@{checkBacklightTimeout}}
\index{checkBacklightTimeout@{checkBacklightTimeout}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{checkBacklightTimeout()}{checkBacklightTimeout()}}
{\footnotesize\ttfamily void Display\+::check\+Backlight\+Timeout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00403}{403}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (backlight\_on\ \&\&\ (millis()\ -\/\ last\_activity\_time\ >\ BACKLIGHT\_TIMEOUT))\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Backlight\ timeout\ reached\ -\/\ turning\ off\ backlight"{}});}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_aa8aef5688a630d912c6d9bd1c764c542}{turnOffBacklight}}();}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00408\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a74136dce435d7a569c5fb00d5f7afbe6}\label{namespace_display_a74136dce435d7a569c5fb00d5f7afbe6}} 
\index{Display@{Display}!cleanup@{cleanup}}
\index{cleanup@{cleanup}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{cleanup()}{cleanup()}}
{\footnotesize\ttfamily void Display\+::cleanup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00099}{99}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clean\ up\ LVGL\ objects}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (qr\_canvas\ \&\&\ lv\_obj\_is\_valid(qr\_canvas))\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_del(qr\_canvas);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ qr\_canvas\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clean\ up\ display\ buffer}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (buf1\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ heap\_caps\_free(buf1);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ buf1\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (buf2\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ heap\_caps\_free(buf2);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ buf2\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Touch\ cleanup\ handled\ automatically\ (stack\ object)}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gfx\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}};}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{namespace_display_a07404a97983810db305db509cbf74a9a}{g}};}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a07404a97983810db305db509cbf74a9a}{g}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bus\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{namespace_display_a73886cb9320187c094593787bd00d01c}{bus}};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a73886cb9320187c094593787bd00d01c}{bus}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Display\ module\ cleaned\ up"{}});}
\DoxyCodeLine{00131\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a78f08fa1900213ef37200b256396765c}\label{namespace_display_a78f08fa1900213ef37200b256396765c}} 
\index{Display@{Display}!displayFlush@{displayFlush}}
\index{displayFlush@{displayFlush}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{displayFlush()}{displayFlush()}}
{\footnotesize\ttfamily void Display\+::display\+Flush (\begin{DoxyParamCaption}\item[{lv\+\_\+disp\+\_\+drv\+\_\+t $\ast$}]{disp,  }\item[{const lv\+\_\+area\+\_\+t $\ast$}]{area,  }\item[{lv\+\_\+color\+\_\+t $\ast$}]{color\+\_\+p }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00188}{188}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ uint32\_t\ w\ =\ lv\_area\_get\_width(area);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ uint32\_t\ h\ =\ lv\_area\_get\_height(area);}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}}-\/>draw16bitRGBBitmap(area-\/>x1,\ area-\/>y1,\ (uint16\_t\ *)color\_p,\ w,\ h);}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}}-\/>flush();}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ lv\_disp\_flush\_ready(disp);}
\DoxyCodeLine{00196\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_ace6d523c48cf82aef610774be829b85b}\label{namespace_display_ace6d523c48cf82aef610774be829b85b}} 
\index{Display@{Display}!displayInvoiceTextFallback@{displayInvoiceTextFallback}}
\index{displayInvoiceTextFallback@{displayInvoiceTextFallback}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{displayInvoiceTextFallback()}{displayInvoiceTextFallback()}}
{\footnotesize\ttfamily void Display\+::display\+Invoice\+Text\+Fallback (\begin{DoxyParamCaption}\item[{const String \&}]{invoice }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00302}{302}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ lv\_obj\_t*\ label\ =\ \mbox{\hyperlink{namespace_u_i_ac9299fb81be88e44c1a7cd5e19db5413}{UI::getInvoiceLabel}}();}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (label\ ==\ \textcolor{keyword}{nullptr}\ ||\ !lv\_obj\_is\_valid(label))\ \{}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Enhanced\ display\ for\ long\ invoices\ that\ can't\ be\ QR\ encoded}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ String\ displayText;}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (invoice.length()\ >\ 300)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ =\ \textcolor{stringliteral}{"{}âš¡\ LIGHTNING\ INVOICE\ âš¡\(\backslash\)n"{}};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ String(invoice.length())\ +\ \textcolor{stringliteral}{"{}\ characters\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}FULL\ INVOICE:\(\backslash\)n"{}};}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ invoice;}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nðŸ“±\ PAYMENT\ OPTIONS:\(\backslash\)n"{}};}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}â€¢\ Copy\ invoice\ text\(\backslash\)n"{}};}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}â€¢\ Use\ NFC/Bluetooth\(\backslash\)n"{}};\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}â€¢\ Manual\ wallet\ paste\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}âš ï¸\ Too\ long\ for\ QR\ display"{}};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ =\ \textcolor{stringliteral}{"{}âš¡\ Lightning\ Invoice:\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ invoice;}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ displayText\ +=\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nðŸ“±\ Scan\ with\ Lightning\ wallet"{}};}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ lv\_label\_set\_text(label,\ displayText.c\_str());}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ lv\_label\_set\_long\_mode(label,\ LV\_LABEL\_LONG\_SCROLL\_CIRCULAR);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ lv\_obj\_set\_width(label,\ 280);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Hide\ spinner}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ lv\_obj\_t*\ spinner\ =\ \mbox{\hyperlink{namespace_u_i_a68428dcbd48587cb1e1e8af2e5b5ba26}{UI::getInvoiceSpinner}}();}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (spinner\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ lv\_obj\_is\_valid(spinner))\ \{}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_add\_flag(spinner,\ LV\_OBJ\_FLAG\_HIDDEN);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Hide\ QR\ canvas\ since\ we're\ not\ using\ it}}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (qr\_canvas\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ lv\_obj\_is\_valid(qr\_canvas))\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_add\_flag(qr\_canvas,\ LV\_OBJ\_FLAG\_HIDDEN);}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Text\ fallback\ display\ configured\ for\ long\ invoice"{}});}
\DoxyCodeLine{00342\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_add3c94239d228504e67b3720541065cc}\label{namespace_display_add3c94239d228504e67b3720541065cc}} 
\index{Display@{Display}!displayQRCode@{displayQRCode}}
\index{displayQRCode@{displayQRCode}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{displayQRCode()}{displayQRCode()}}
{\footnotesize\ttfamily void Display\+::display\+QRCode (\begin{DoxyParamCaption}\item[{const String \&}]{invoice }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00240}{240}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}===\ Display::displayQRCode\ starting\ ==="{}});}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Free\ heap:\ "{}}\ +\ String(ESP.getFreeHeap()));}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Invoice\ length:\ "{}}\ +\ String(invoice.length()));}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (qr\_canvas\ ==\ \textcolor{keyword}{nullptr}\ ||\ !lv\_obj\_is\_valid(qr\_canvas))\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ QR\ canvas\ not\ available"{}});}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_ace6d523c48cf82aef610774be829b85b}{displayInvoiceTextFallback}}(invoice);}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Safety\ check\ -\/\ ensure\ invoice\ is\ not\ empty}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (invoice.length()\ ==\ 0)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Empty\ invoice\ string"{}});}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ displayInvoiceTextFallback(invoice);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ QR\ code\ size\ -\/\ LVGL\ handles\ sizing\ automatically}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ uint16\_t\ qr\_size\ =\ 280;\ \textcolor{comment}{//\ QR\ pixel\ size}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Creating\ LVGL\ QR\ code\ with\ size\ \%dx\%d\ for\ \%d\ character\ invoice\(\backslash\)n"{}},\ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ qr\_size,\ qr\_size,\ invoice.length());}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ LVGL\ QR\ code\ object\ with\ all\ parameters}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ lv\_obj\_t*\ qr\ =\ lv\_qrcode\_create(qr\_canvas,\ qr\_size,\ lv\_color\_black(),\ lv\_color\_white());}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (qr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ create\ LVGL\ QR\ code\ object"{}});}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_ace6d523c48cf82aef610774be829b85b}{displayInvoiceTextFallback}}(invoice);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ QR\ code\ data\ -\/\ LVGL\ handles\ all\ the\ complexity}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ lv\_res\_t\ result\ =\ lv\_qrcode\_update(qr,\ invoice.c\_str(),\ invoice.length());}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ LV\_RES\_OK)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ update\ QR\ code\ data,\ result:\ \%d\(\backslash\)n"{}},\ result);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_del(qr);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_ace6d523c48cf82aef610774be829b85b}{displayInvoiceTextFallback}}(invoice);}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Center\ the\ QR\ code\ in\ the\ canvas}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ lv\_obj\_center(qr);}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Hide\ spinner\ and\ text\ label\ since\ we\ have\ QR\ code}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ lv\_obj\_t*\ spinner\ =\ \mbox{\hyperlink{namespace_u_i_a68428dcbd48587cb1e1e8af2e5b5ba26}{UI::getInvoiceSpinner}}();}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (spinner\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ lv\_obj\_is\_valid(spinner))\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_add\_flag(spinner,\ LV\_OBJ\_FLAG\_HIDDEN);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ lv\_obj\_t*\ label\ =\ \mbox{\hyperlink{namespace_u_i_ac9299fb81be88e44c1a7cd5e19db5413}{UI::getInvoiceLabel}}();}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (label\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ lv\_obj\_is\_valid(label))\ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_obj\_add\_flag(label,\ LV\_OBJ\_FLAG\_HIDDEN);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Show\ QR\ canvas}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ lv\_obj\_clear\_flag(qr\_canvas,\ LV\_OBJ\_FLAG\_HIDDEN);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}QR\ code\ successfully\ created\ and\ displayed\ using\ LVGL"{}});}
\DoxyCodeLine{00299\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a18c2dedb3287a8213f6a7d8ce61de740}\label{namespace_display_a18c2dedb3287a8213f6a7d8ce61de740}} 
\index{Display@{Display}!getGFX@{getGFX}}
\index{getGFX@{getGFX}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{getGFX()}{getGFX()}}
{\footnotesize\ttfamily Arduino\+\_\+\+GFX \& Display\+::get\+GFX (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00345}{345}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}};}
\DoxyCodeLine{00347\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a0c478a57b622918a8499d369db409f85}\label{namespace_display_a0c478a57b622918a8499d369db409f85}} 
\index{Display@{Display}!getLastTouch@{getLastTouch}}
\index{getLastTouch@{getLastTouch}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{getLastTouch()}{getLastTouch()}}
{\footnotesize\ttfamily void Display\+::get\+Last\+Touch (\begin{DoxyParamCaption}\item[{int32\+\_\+t \&}]{x,  }\item[{int32\+\_\+t \&}]{y }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00357}{357}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ x\ =\ last\_x;}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ y\ =\ last\_y;}
\DoxyCodeLine{00360\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_acb0d0237a8d03c78c35bad1248d26eeb}\label{namespace_display_acb0d0237a8d03c78c35bad1248d26eeb}} 
\index{Display@{Display}!getQRCanvas@{getQRCanvas}}
\index{getQRCanvas@{getQRCanvas}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{getQRCanvas()}{getQRCanvas()}}
{\footnotesize\ttfamily lv\+\_\+obj\+\_\+t $\ast$ Display\+::get\+QRCanvas (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00349}{349}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ qr\_canvas;}
\DoxyCodeLine{00351\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_aacbf91b9f8c57fc2cb892c45fd44e655}\label{namespace_display_aacbf91b9f8c57fc2cb892c45fd44e655}} 
\index{Display@{Display}!init@{init}}
\index{init@{init}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily void Display\+::init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00038}{38}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}===\ Initializing\ ArduinoGFX\ display\ ==="{}});}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ ArduinoGFX\ display}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Creating\ bus..."{}});}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a73886cb9320187c094593787bd00d01c}{bus}}\ =\ \textcolor{keyword}{new}\ Arduino\_ESP32QSPI(\mbox{\hyperlink{pincfg_8h_a5f4d46ae101b77df78010c506601c87c}{TFT\_CS}},\ \mbox{\hyperlink{pincfg_8h_ad71e70999bd20c255b8f3f2ce89722d9}{TFT\_SCK}},\ \mbox{\hyperlink{pincfg_8h_a0ce0d651c46fde5cbaf7801404dabe91}{TFT\_SDA0}},\ \mbox{\hyperlink{pincfg_8h_a320010aba9dff9b68b8bc9ed50fe5dba}{TFT\_SDA1}},\ \mbox{\hyperlink{pincfg_8h_a01714c1a1a5f15730e6c48a81abeee6d}{TFT\_SDA2}},\ \mbox{\hyperlink{pincfg_8h_a86ad39a86a6a24439da28f19c47dc6f4}{TFT\_SDA3}});}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Creating\ display..."{}});}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a07404a97983810db305db509cbf74a9a}{g}}\ =\ \textcolor{keyword}{new}\ Arduino\_AXS15231B(bus,\ GFX\_NOT\_DEFINED,\ 0,\ \textcolor{keyword}{false},\ \mbox{\hyperlink{dispcfg_8h_a7e76b7900a303c107f31414b2e231edb}{TFT\_res\_W}},\ \mbox{\hyperlink{dispcfg_8h_a3ed892b03a04858b1d132412428d5c97}{TFT\_res\_H}});}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Creating\ canvas..."{}});}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}}\ =\ \textcolor{keyword}{new}\ Arduino\_Canvas(\mbox{\hyperlink{dispcfg_8h_a7e76b7900a303c107f31414b2e231edb}{TFT\_res\_W}},\ \mbox{\hyperlink{dispcfg_8h_a3ed892b03a04858b1d132412428d5c97}{TFT\_res\_H}},\ g,\ 0,\ 0,\ \mbox{\hyperlink{dispcfg_8h_a966806ff3abf821022944c7aa191f997}{TFT\_rot}});}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Starting\ display..."{}});}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{namespace_display_a6c60868b4fdb5a872686070ea0607be3}{gfx}}-\/>begin(40000000UL))\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ initialize\ display!"{}});}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Display\ initialized\ successfully"{}});}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ backlight\ pin\ and\ turn\ on\ backlight}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ pinMode(\mbox{\hyperlink{pincfg_8h_a541b5fc642dbcc81f373d4b866c88f80}{TFT\_BL}},\ OUTPUT);}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ turnOnBacklight();}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ initBacklightTimeout();}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clear\ display}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Clearing\ display..."{}});}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ gfx-\/>fillScreen(BLACK);}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ gfx-\/>flush();}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Display\ cleared"{}});}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Basic\ touch\ initialization\ only}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}===\ TOUCH\ INITIALIZATION\ ==="{}});}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ touch\ controller}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Initializing\ touch\ controller..."{}});}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Touch\ pins\ -\/\ SDA:\%d,\ SCL:\%d,\ INT:\%d,\ ADDR:0x\%02X\(\backslash\)n"{}},\ \mbox{\hyperlink{pincfg_8h_a2aa469c181d9c18e7f810f7c2505732e}{Touch\_SDA}},\ \mbox{\hyperlink{pincfg_8h_aadfd1e71ec456dc27c0b939972b57425}{Touch\_SCL}},\ \mbox{\hyperlink{pincfg_8h_a5a0375f1cc3ad48d5b72844acf697f1e}{Touch\_INT}},\ \mbox{\hyperlink{pincfg_8h_a47174ce4cf77383332568190e90e7e2e}{Touch\_ADDR}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!touch.\mbox{\hyperlink{class_a_x_s15231_b___touch_af21a70509a9e97ff91767e8ca19c8586}{begin}}())\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ initialize\ touch\ controller!"{}});}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Continue\ anyway\ for\ debugging}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Touch\ controller\ initialized\ successfully"{}});}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configure\ touch\ calibration}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}{touch}}.\mbox{\hyperlink{class_a_x_s15231_b___touch_a7185bee1c9f8ef1f1cb3ddcdc8c094b7}{enOffsetCorrection}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}{touch}}.\mbox{\hyperlink{class_a_x_s15231_b___touch_a5f7d916f1c81254768c73c84d19ab1f6}{setOffsets}}(\mbox{\hyperlink{dispcfg_8h_ab02852ca4298c30325151b824f672482}{Touch\_X\_min}},\ \mbox{\hyperlink{dispcfg_8h_a583b55e2ca8bb7f5659ba4c88a69c114}{Touch\_X\_max}},\ \mbox{\hyperlink{dispcfg_8h_a7e76b7900a303c107f31414b2e231edb}{TFT\_res\_W}}-\/1,\ \mbox{\hyperlink{dispcfg_8h_a1d8fe9a018aa50b9683f4413d255c534}{Touch\_Y\_min}},\ \mbox{\hyperlink{dispcfg_8h_a36ccd5c68c4d57b6639e489cd390a02d}{Touch\_Y\_max}},\ \mbox{\hyperlink{dispcfg_8h_a3ed892b03a04858b1d132412428d5c97}{TFT\_res\_H}}-\/1);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Touch\ calibration\ configured"{}});}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ LVGL}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Initializing\ LVGL..."{}});}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_init();}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}LVGL\ initialized,\ setting\ up\ display\ driver..."{}});}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_ac8bef7d31e6dd87afcbcac8477f4c5c9}{setupLVGL}}();}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}===\ ArduinoGFX\ display\ initialization\ complete\ ==="{}});}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (...)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}EXCEPTION\ during\ display\ initialization!"{}});}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00097\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_aece4179acb03a4966d7064ef6946b091}\label{namespace_display_aece4179acb03a4966d7064ef6946b091}} 
\index{Display@{Display}!initBacklightTimeout@{initBacklightTimeout}}
\index{initBacklightTimeout@{initBacklightTimeout}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{initBacklightTimeout()}{initBacklightTimeout()}}
{\footnotesize\ttfamily void Display\+::init\+Backlight\+Timeout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00393}{393}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ last\_activity\_time\ =\ millis();}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ backlight\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Backlight\ timeout\ initialized\ -\/\ 60\ second\ timeout"{}});}
\DoxyCodeLine{00397\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a28603b6415f9f3c21a4e9fed5ed180e3}\label{namespace_display_a28603b6415f9f3c21a4e9fed5ed180e3}} 
\index{Display@{Display}!isBacklightOn@{isBacklightOn}}
\index{isBacklightOn@{isBacklightOn}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{isBacklightOn()}{isBacklightOn()}}
{\footnotesize\ttfamily bool Display\+::is\+Backlight\+On (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00410}{410}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ backlight\_on;}
\DoxyCodeLine{00412\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a694dddf11915e58ecf50e9d9f0e9307f}\label{namespace_display_a694dddf11915e58ecf50e9d9f0e9307f}} 
\index{Display@{Display}!resetBacklightTimeout@{resetBacklightTimeout}}
\index{resetBacklightTimeout@{resetBacklightTimeout}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{resetBacklightTimeout()}{resetBacklightTimeout()}}
{\footnotesize\ttfamily void Display\+::reset\+Backlight\+Timeout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00399}{399}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ last\_activity\_time\ =\ millis();}
\DoxyCodeLine{00401\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a77664f233d6b5e98be33985eed783600}\label{namespace_display_a77664f233d6b5e98be33985eed783600}} 
\index{Display@{Display}!setBacklightBrightness@{setBacklightBrightness}}
\index{setBacklightBrightness@{setBacklightBrightness}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{setBacklightBrightness()}{setBacklightBrightness()}}
{\footnotesize\ttfamily void Display\+::set\+Backlight\+Brightness (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{brightness }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00363}{363}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ArduinoGFX\ doesn't\ have\ built-\/in\ brightness\ control}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ PWM\ on\ backlight\ pin\ for\ brightness\ control}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ analogWrite(\mbox{\hyperlink{pincfg_8h_a541b5fc642dbcc81f373d4b866c88f80}{TFT\_BL}},\ brightness);}
\DoxyCodeLine{00367\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a265f5a3b090df04fb0b928b84a2d7e17}\label{namespace_display_a265f5a3b090df04fb0b928b84a2d7e17}} 
\index{Display@{Display}!setQRCanvas@{setQRCanvas}}
\index{setQRCanvas@{setQRCanvas}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{setQRCanvas()}{setQRCanvas()}}
{\footnotesize\ttfamily void Display\+::set\+QRCanvas (\begin{DoxyParamCaption}\item[{lv\+\_\+obj\+\_\+t $\ast$}]{canvas }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00353}{353}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ qr\_canvas\ =\ canvas;}
\DoxyCodeLine{00355\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a5edb1eb6aad9305091ed3479edc983d6}\label{namespace_display_a5edb1eb6aad9305091ed3479edc983d6}} 
\index{Display@{Display}!setRotation@{setRotation}}
\index{setRotation@{setRotation}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{setRotation()}{setRotation()}}
{\footnotesize\ttfamily void Display\+::set\+Rotation (\begin{DoxyParamCaption}\item[{int}]{rotation }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00133}{133}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ArduinoGFX\ rotation\ is\ set\ during\ Canvas\ creation}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ runtime\ rotation\ changes,\ would\ need\ to\ recreate\ canvas}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Rotation\ set\ to:\ \%d\(\backslash\)n"{}},\ rotation);}
\DoxyCodeLine{00137\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_ac8bef7d31e6dd87afcbcac8477f4c5c9}\label{namespace_display_ac8bef7d31e6dd87afcbcac8477f4c5c9}} 
\index{Display@{Display}!setupLVGL@{setupLVGL}}
\index{setupLVGL@{setupLVGL}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{setupLVGL()}{setupLVGL()}}
{\footnotesize\ttfamily void Display\+::setup\+LVGL (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00139}{139}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Increase\ buffer\ size\ for\ smoother\ rendering}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ uint32\_t\ bufSize\ =\ screenWidth\ *\ screenHeight\ /\ 5;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ buf1\ =\ (lv\_color\_t*)heap\_caps\_malloc(bufSize\ *\ \textcolor{keyword}{sizeof}(lv\_color\_t),\ MALLOC\_CAP\_INTERNAL\ |\ MALLOC\_CAP\_8BIT);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ buf2\ =\ (lv\_color\_t*)heap\_caps\_malloc(bufSize\ *\ \textcolor{keyword}{sizeof}(lv\_color\_t),\ MALLOC\_CAP\_INTERNAL\ |\ MALLOC\_CAP\_8BIT);}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!buf1\ ||\ !buf2)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ allocate\ LVGL\ display\ buffer!"{}});}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ buffer\ to\ use\ for\ display}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ lv\_disp\_draw\_buf\_init(\&draw\_buf,\ buf1,\ buf2,\ bufSize);}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ \&\ Initialize\ the\ display\ device\ driver}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ lv\_disp\_drv\_t\ disp\_drv;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ lv\_disp\_drv\_init(\&disp\_drv);}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ disp\_drv.hor\_res\ =\ screenWidth;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ disp\_drv.ver\_res\ =\ screenHeight;}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ disp\_drv.flush\_cb\ =\ displayFlush;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ disp\_drv.draw\_buf\ =\ \&draw\_buf;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ lv\_disp\_drv\_register(\&disp\_drv);}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Setup\ \&\ Initialize\ the\ input\ device\ driver}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ lv\_indev\_drv\_t\ indev\_drv;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ lv\_indev\_drv\_init(\&indev\_drv);}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ indev\_drv.type\ =\ LV\_INDEV\_TYPE\_POINTER;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ indev\_drv.read\_cb\ =\ touchpadRead;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ input\ device\ polling\ period\ (default\ might\ be\ too\ slow\ or\ disabled)}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ indev\_drv.read\_timer\ =\ NULL;\ \textcolor{comment}{//\ Let\ LVGL\ create\ its\ own\ timer}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ lv\_indev\_t\ *indev\ =\ lv\_indev\_drv\_register(\&indev\_drv);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (indev)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}LVGL\ input\ device\ registered\ successfully"{}});}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Input\ device\ pointer:\ \%p\(\backslash\)n"{}},\ indev);}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ensure\ the\ input\ device\ is\ set\ as\ the\ active\ one}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ lv\_indev\_set\_group(indev,\ lv\_group\_get\_default());}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Input\ device\ linked\ to\ default\ group"{}});}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}ERROR:\ Failed\ to\ register\ LVGL\ input\ device!"{}});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}LVGL\ initialized\ with\ ArduinoGFX\ backend"{}});}
\DoxyCodeLine{00185\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a3d51aeecf9902984e423412bbe757155}\label{namespace_display_a3d51aeecf9902984e423412bbe757155}} 
\index{Display@{Display}!touchpadRead@{touchpadRead}}
\index{touchpadRead@{touchpadRead}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{touchpadRead()}{touchpadRead()}}
{\footnotesize\ttfamily void Display\+::touchpad\+Read (\begin{DoxyParamCaption}\item[{lv\+\_\+indev\+\_\+drv\+\_\+t $\ast$}]{indev\+\_\+driver,  }\item[{lv\+\_\+indev\+\_\+data\+\_\+t $\ast$}]{data }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00199}{199}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ last\_touch\_state\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ uint16\_t\ touchX,\ touchY;}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ currently\_touched\ =\ \mbox{\hyperlink{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}{touch}}.\mbox{\hyperlink{class_a_x_s15231_b___touch_a96f053e30928d0fd8046a281a5cdaefb}{touched}}();}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (currently\_touched)\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ backlight\ timeout\ and\ turn\ backlight\ on\ if\ it\ was\ off}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a694dddf11915e58ecf50e9d9f0e9307f}{resetBacklightTimeout}}();}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!backlight\_on)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a75d875ec473cbdd00bee7951951d81c0}{turnOnBacklight}}();}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backlight\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Handle\ touch\ wake\ from\ light\ sleep\ first}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_app_afebab729ad90b87d5c556255298b5f8b}{App::handleTouchWake}}();}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ wake\ grace\ period\ needed\ for\ continuous\ monitoring}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ touched\ point\ from\ touch\ module}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ touch.\mbox{\hyperlink{class_a_x_s15231_b___touch_a986f12df1baa1ade792189af93c08086}{readData}}(\&touchX,\ \&touchY);}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ coordinates\ (LVGL\ will\ handle\ object\ detection\ and\ events\ automatically)}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ data-\/>point.x\ =\ touchX;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ data-\/>point.y\ =\ touchY;}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ data-\/>state\ =\ LV\_INDEV\_STATE\_PRESSED;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ last\_x\ =\ touchX;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ last\_y\ =\ touchY;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ //\ Simple\ debug\ output\ for\ new\ touches}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ (!last\_touch\_state)\ \{}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ Serial.printf("{}Touch:\ X=\%d,\ Y=\%d\(\backslash\)n"{},\ touchX,\ touchY);}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ data-\/>state\ =\ LV\_INDEV\_STATE\_RELEASED;}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ last\_touch\_state\ =\ currently\_touched;}
\DoxyCodeLine{00237\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_aa8aef5688a630d912c6d9bd1c764c542}\label{namespace_display_aa8aef5688a630d912c6d9bd1c764c542}} 
\index{Display@{Display}!turnOffBacklight@{turnOffBacklight}}
\index{turnOffBacklight@{turnOffBacklight}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{turnOffBacklight()}{turnOffBacklight()}}
{\footnotesize\ttfamily void Display\+::turn\+Off\+Backlight (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00369}{369}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Turning\ off\ display\ backlight"{}});}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ digitalWrite(\mbox{\hyperlink{pincfg_8h_a541b5fc642dbcc81f373d4b866c88f80}{TFT\_BL}},\ LOW);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ backlight\_on\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00373\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a75d875ec473cbdd00bee7951951d81c0}\label{namespace_display_a75d875ec473cbdd00bee7951951d81c0}} 
\index{Display@{Display}!turnOnBacklight@{turnOnBacklight}}
\index{turnOnBacklight@{turnOnBacklight}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{turnOnBacklight()}{turnOnBacklight()}}
{\footnotesize\ttfamily void Display\+::turn\+On\+Backlight (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00375}{375}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Turning\ on\ display\ backlight"{}});}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ digitalWrite(\mbox{\hyperlink{pincfg_8h_a541b5fc642dbcc81f373d4b866c88f80}{TFT\_BL}},\ HIGH);}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ backlight\_on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00379\ \ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespace_display_a4882df71e0a4d79fcf601ee407c01c39}\label{namespace_display_a4882df71e0a4d79fcf601ee407c01c39}} 
\index{Display@{Display}!turnOnBacklightForSigning@{turnOnBacklightForSigning}}
\index{turnOnBacklightForSigning@{turnOnBacklightForSigning}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{turnOnBacklightForSigning()}{turnOnBacklightForSigning()}}
{\footnotesize\ttfamily void Display\+::turn\+On\+Backlight\+For\+Signing (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Turn on backlight for signing event with reduced backlight turn off timeout. 



Definition at line \mbox{\hyperlink{display_8cpp_source_l00385}{385}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Turning\ on\ backlight\ for\ signing\ event"{}});}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a75d875ec473cbdd00bee7951951d81c0}{turnOnBacklight}}();}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_display_a694dddf11915e58ecf50e9d9f0e9307f}{resetBacklightTimeout}}();}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ last\_activity\_time\ -\/=\ (BACKLIGHT\_TIMEOUT\ -\/\ EVENT\_SIGNING\_BACKLIGHT\_TIMEOUT);}
\DoxyCodeLine{00390\ \ \ \ \ \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespace_display_a73886cb9320187c094593787bd00d01c}\label{namespace_display_a73886cb9320187c094593787bd00d01c}} 
\index{Display@{Display}!bus@{bus}}
\index{bus@{bus}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{bus}{bus}}
{\footnotesize\ttfamily Arduino\+\_\+\+Data\+Bus $\ast$ Display\+::bus = nullptr}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00013}{13}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.

\mbox{\Hypertarget{namespace_display_a07404a97983810db305db509cbf74a9a}\label{namespace_display_a07404a97983810db305db509cbf74a9a}} 
\index{Display@{Display}!g@{g}}
\index{g@{g}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{g}{g}}
{\footnotesize\ttfamily Arduino\+\_\+\+GFX $\ast$ Display\+::g = nullptr}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00014}{14}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.

\mbox{\Hypertarget{namespace_display_a6c60868b4fdb5a872686070ea0607be3}\label{namespace_display_a6c60868b4fdb5a872686070ea0607be3}} 
\index{Display@{Display}!gfx@{gfx}}
\index{gfx@{gfx}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{gfx}{gfx}}
{\footnotesize\ttfamily Arduino\+\_\+\+Canvas $\ast$ Display\+::gfx = nullptr}



Definition at line \mbox{\hyperlink{display_8cpp_source_l00015}{15}} of file \mbox{\hyperlink{display_8cpp_source}{display.\+cpp}}.

\mbox{\Hypertarget{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}\label{namespace_display_a0c9cc8a26de50584375ead7c4553f30b}} 
\index{Display@{Display}!touch@{touch}}
\index{touch@{touch}!Display@{Display}}
\doxysubsubsection{\texorpdfstring{touch}{touch}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_a_x_s15231_b___touch}{AXS15231\+B\+\_\+\+Touch}} Display\+::touch (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{pincfg_8h_aadfd1e71ec456dc27c0b939972b57425}{Touch\+\_\+\+SCL}}}]{,  }\item[{\mbox{\hyperlink{pincfg_8h_a2aa469c181d9c18e7f810f7c2505732e}{Touch\+\_\+\+SDA}}}]{,  }\item[{\mbox{\hyperlink{pincfg_8h_a5a0375f1cc3ad48d5b72844acf697f1e}{Touch\+\_\+\+INT}}}]{,  }\item[{\mbox{\hyperlink{pincfg_8h_a47174ce4cf77383332568190e90e7e2e}{Touch\+\_\+\+ADDR}}}]{,  }\item[{\mbox{\hyperlink{dispcfg_8h_a966806ff3abf821022944c7aa191f997}{TFT\+\_\+rot}}}]{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{display_8h_source_l00019}{19}} of file \mbox{\hyperlink{display_8h_source}{display.\+h}}.

