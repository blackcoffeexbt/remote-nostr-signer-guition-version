\hypertarget{nip44_8h_source}{}\doxysection{nip44.\+h}
\label{nip44_8h_source}\index{lib/nostr/nip44/nip44.h@{lib/nostr/nip44/nip44.h}}
\mbox{\hyperlink{nip44_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00001}00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00006}00006\ \textcolor{comment}{//\ NIP-\/44\ constant\ salt}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00007}00007\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint8\_t\ \mbox{\hyperlink{nip44_8h_ab3580d289ffb91f2ee6e86b49248c0bd}{NIP44\_SALT}}[8];}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00009}00009\ \textcolor{comment}{//\ Helper\ functions}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00010}00010\ uint32\_t\ \mbox{\hyperlink{nip44_8h_aef32c7ca28c0cd7b60d37f47bb000170}{\_math\_int\_log2}}(uint32\_t\ x);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00011}00011\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{nip44_8h_ace0160702e57dc7c72454879d8f0631e}{calcPaddedLen}}(\textcolor{keywordtype}{size\_t}\ unpadded\_len);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00012}00012\ std::vector<uint8\_t>\ \mbox{\hyperlink{nip44_8h_ac24379517e65e887cbbdc17891ab8e9a}{padMessage}}(\textcolor{keyword}{const}\ String\ \&plaintext);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00013}00013\ String\ \mbox{\hyperlink{nip44_8h_a6024adb12987206510b8794820ea53c5}{unpadMessage}}(\textcolor{keyword}{const}\ std::vector<uint8\_t>\ \&padded);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00015}00015\ \textcolor{comment}{//\ Cryptographic\ functions}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00016}00016\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{nip44_8h_adabe0c22a9ec0eb1995a13c9d18cbfbd}{hkdf\_sha256}}(\textcolor{keyword}{const}\ uint8\_t\ *salt,\ \textcolor{keywordtype}{size\_t}\ salt\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *ikm,\ \textcolor{keywordtype}{size\_t}\ ikm\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00018}00018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *info,\ \textcolor{keywordtype}{size\_t}\ info\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *okm,\ \textcolor{keywordtype}{size\_t}\ okm\_len);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00021}00021\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{nip44_8h_a2e10b2184c762247271948f4cc2db136}{getMessageKeys}}(\textcolor{keyword}{const}\ uint8\_t\ *conversation\_key,\ \textcolor{keyword}{const}\ uint8\_t\ *nonce,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *chacha\_key,\ uint8\_t\ *chacha\_nonce,\ uint8\_t\ *hmac\_key);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00024}00024\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{nip44_8h_aae1b96189dd9a1799371b399dcd5b5df}{hmac\_aad}}(\textcolor{keyword}{const}\ uint8\_t\ *key,\ \textcolor{keywordtype}{size\_t}\ key\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *message,\ \textcolor{keywordtype}{size\_t}\ msg\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *aad,\ \textcolor{keywordtype}{size\_t}\ aad\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ *output);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00029}00029\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{nip44_8h_a0d30e05c3789532f7d623aa456dfc4a5}{verifyBase64}}(\textcolor{keyword}{const}\ std::vector<uint8\_t>\&\ input,\ String\&\ output);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00030}00030\ String\ \mbox{\hyperlink{nip44_8h_a9506ca2d042968bd0ae27489e0f55916}{base64\_encode}}(\textcolor{keyword}{const}\ uint8\_t*\ input,\ \textcolor{keywordtype}{size\_t}\ length);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00032}00032\ \textcolor{comment}{//\ Main\ encryption/decryption\ functions}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00033}00033\ String\ \mbox{\hyperlink{nip44_8h_a6abc2f603f8e9809edfe83696548800e}{encryptMessageNip44}}(\textcolor{keyword}{const}\ String\ \&plaintext,\ \textcolor{keyword}{const}\ String\ \&sharedSecretHex);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00034}00034\ String\ \mbox{\hyperlink{nip44_8h_af4405bcf332e970f6a885d00e1e1a325}{decryptMessageNip44}}(\textcolor{keyword}{const}\ String\ \&payload,\ \textcolor{keyword}{const}\ String\ \&sharedSecretHex);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00036}00036\ \textcolor{comment}{//\ HMAC-\/SHA256\ implementation}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00037}00037\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{nip44_8h_a8658c09e51abaf63e23f7beabc2c04b5}{hmac\_sha256}}(\textcolor{keyword}{const}\ uint8\_t*\ key,\ \textcolor{keywordtype}{size\_t}\ key\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ msg,\ \textcolor{keywordtype}{size\_t}\ msg\_len,}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t*\ hmac);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00041}00041\ \textcolor{comment}{//\ High-\/level\ execution\ functions}}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00042}00042\ String\ \mbox{\hyperlink{nip44_8h_a9fca4f5d3adc798444724f0ef23cb0c6}{executeEncryptMessageNip44}}(String\ data,\ String\ privateKeyHex,\ String\ thirdPartyPublicKeyHex);}
\DoxyCodeLine{\Hypertarget{nip44_8h_source_l00043}00043\ String\ \mbox{\hyperlink{nip44_8h_a131b96ad7e7f560b2fd7194ade183695}{executeDecryptMessageNip44}}(String\ data,\ String\ privateKeyHex,\ String\ thirdPartyPublicKeyHex);}

\end{DoxyCode}
